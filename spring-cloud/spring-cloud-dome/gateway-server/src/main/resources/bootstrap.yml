server:
  port: 80

spring:
  application:
    name: gateway-server
    config:
      enabled: true
      profile: test
      label: master
      discovery:
        service-id: CONFIG-SERVER
        enabled: true
      fail-fast: true
      retry:
        max-attempts: 6
        max-interval: 3000
        initial-interval: 2000
        multiplier: 1
    cloud:
      gateway:
        discovery:
          locator:
            enabled: false
        routes:
          - id: api-order
            uri: lb://ORDER-SERVER
            filters:
              - StripPrefix=1
              - name: RequestRateLimiter
                args:
                  redis-rate-limiter.replenishRate: 1 #令牌桶每秒填充平均速率
                  redis-rate-limiter.burstCapacity: 5 #令牌桶总容量
                  key-resolver: "#{@ipKeyResolver}" #限流的键的解析器的 Bean 对象的名字
            predicates:
              - Path=/api-order/**
          - id: api-goods
            uri: lb://GOODS-SERVER
            filters:
              - StripPrefix=1
            predicates:
              - Path=/api-goods/**

eureka:
  instance:
    appname: gateway-server
    prefer-ip-address: true
    metadata-map:
      user.name: admin
      user.password: admin
  client:
    service-url:
      defaultZone: http://admin:admin@127.0.0.1:18761/eureka/

